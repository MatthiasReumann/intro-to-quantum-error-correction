\begin{figure*}
    \centering
    \begin{tikzpicture}[scale=0.9]
        \node at (-0.7, 0.45) {\large$M_{1}:$};
        
        
        \fill[color=rgray, rounded corners=4pt] (-0.1, -0.1) rectangle (4.9, 1.1);
        \draw[color=black, fill=rblue2, thin] (0.0,0) rectangle (0.7,1) node[midway] {\textcolor{black}{$\ket{0}$}};
        \draw[color=black, fill=rblue2, thin] (0.7,0) rectangle (1.4,1) node[midway] {\textcolor{black}{$\ket{0}$}};
        \draw[color=black, fill=white, thin] (1.4,0) rectangle (2.1,1) node[midway] {\textcolor{black}{$\ket{1}$}};

        \node at (2.4, 0.5) {\large$+$};

        \draw[color=black, fill=rblue2, thin] (2.7,0) rectangle (3.4,1) node[midway] {\textcolor{black}{$\ket{1}$}};
        \draw[color=black, fill=rblue2, thin] (3.4,0) rectangle (4.1,1) node[midway] {\textcolor{black}{$\ket{1}$}};
        \draw[color=black, fill=white, thin] (4.1,0) rectangle (4.8,1) node[midway] {\textcolor{black}{$\ket{0}$}};

        \node at (5.1, 0.5) {$\otimes$};

        \fill[color=rgray, rounded corners=4pt] (5.3, -0.1) rectangle (10.3, 1.1);
        \draw[color=black, fill=white, thin] (5.4,0) rectangle (6.1,1) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (6.1,0) rectangle (6.8,1) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (6.8,0) rectangle (7.5,1) node[midway] {$\ket{0}$};

        \node at (7.8, 0.5) {\large$+$};

        \draw[color=black, fill=white,thin] (8.1, 0) rectangle (8.8,1) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (8.8,0) rectangle (9.5,1) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (9.5,0) rectangle (10.2,1) node[midway] {$\ket{1}$};

        \node at (10.5, 0.5) {$\otimes$};

         
        \fill[color=rgray, rounded corners=4pt] (10.7, -0.1) rectangle (15.7, 1.1);
        \draw[color=black, fill=white,thin] (10.8,0) rectangle (11.5,1) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (11.5,0) rectangle (12.2,1) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (12.2,0) rectangle (12.9,1) node[midway] {$\ket{0}$};

        \node at (13.2, 0.5) {\large$+$};

        \draw[color=black, fill=white,thin] (13.5,0) rectangle (14.2,1) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (14.2,0) rectangle (14.9,1) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (14.9,0) rectangle (15.6,1) node[midway] {$\ket{1}$};

        \node at (16.3, 0.5) {$0$ ($\circ$)};
        
        
        
        \node at (-0.7, -1) {\large$M_{2}:$};

        
        \fill[color=rgray, rounded corners=4pt] (-0.1, -1.6) rectangle (4.9, -0.4);
        \draw[color=black, fill=white,thin] (0.0,-1.5) rectangle (0.7,-0.5) node[midway] {\textcolor{black}{$\ket{0}$}};
        \draw[color=black, fill=rblue2, thin] (0.7,-1.5) rectangle (1.4,-0.5) node[midway] {\textcolor{black}{$\ket{0}$}};
        \draw[color=black, fill=rblue2, thin] (1.4,-1.5) rectangle (2.1,-0.5) node[midway] {\textcolor{black}{$\ket{1}$}};

        \node at (2.4, -1) {\large$+$};

        \draw[color=black, fill=white,thin] (2.7,-1.5) rectangle (3.4,-0.5) node[midway] {\textcolor{black}{$\ket{1}$}};
        \draw[color=black, fill=rblue2, thin] (3.4,-1.5) rectangle (4.1,-0.5) node[midway] {\textcolor{black}{$\ket{1}$}};
        \draw[color=black, fill=rblue2, thin] (4.1,-1.5) rectangle (4.8,-0.5) node[midway] {\textcolor{black}{$\ket{0}$}};

        \node at (5.1, -1) {$\otimes$};

        
        \fill[color=rgray, rounded corners=4pt] (5.3, -1.6) rectangle (10.3, -0.4);
        \draw[color=black, fill=white,thin] (5.4,-1.5) rectangle (6.1,-0.5) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (6.1,-1.5) rectangle (6.8,-0.5) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (6.8,-1.5) rectangle (7.5,-0.5) node[midway] {$\ket{0}$};

        \node at (7.8, -1) {\large$+$};

        \draw[color=black, fill=white,thin] (8.1, -1.5) rectangle (8.8,-0.5) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (8.8,-1.5) rectangle (9.5,-0.5) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (9.5,-1.5) rectangle (10.2,-0.5) node[midway] {$\ket{1}$};

        \node at (10.5, -1) {$\otimes$};

        
        \fill[color=rgray, rounded corners=4pt] (10.7, -1.6) rectangle (15.7, -0.4);
        \draw[color=black, fill=white,thin] (10.8,-1.5) rectangle (11.5,-0.5) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (11.5,-1.5) rectangle (12.2,-0.5) node[midway] {$\ket{0}$};
        \draw[color=black, fill=white,thin] (12.2,-1.5) rectangle (12.9,-0.5) node[midway] {$\ket{0}$};

        \node at (13.2, -1) {\large$+$};

        \draw[color=black, fill=white,thin] (13.5,-1.5) rectangle (14.2,-0.5) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (14.2,-1.5) rectangle (14.9,-0.5) node[midway] {$\ket{1}$};
        \draw[color=black, fill=white,thin] (14.9,-1.5) rectangle (15.6,-0.5) node[midway] {$\ket{1}$};

        \node at (16.3, -1) {$1$ (\textcolor{rblue3}{$\bullet$})};

        
        \draw[color=black, densely dashed, thin, rounded corners=4pt] (1.3,1.1) rectangle (2.2,-1.6);
        \draw[color=black, densely dashed, thin, rounded corners=4pt] (4,1.1) rectangle (4.9,-1.6);
    \end{tikzpicture}
    \caption{Syndrome measurement of the stabilizers $M_{1}$ and $M_{2}$ on the $\ket{0_L}$ state for the Shor code where the third qubit has been bit-flipped.}\label{fig:synd-msmt}
\end{figure*}